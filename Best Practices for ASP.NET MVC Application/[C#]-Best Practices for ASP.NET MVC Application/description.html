<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=E26C1359372FE948C3C39B3F0FB94413" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/007decc8-6c12-4163-b4b5-9d2256e5c10eCombined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=76DF6246C5394201214B48DD1A8F406B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Best Practices for ASP.NET MVC Application</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Best Practices for ASP.NET MVC Application</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            WCF, themes, Entity Framework, ASP.NET MVC 3, Razor, Theme, Code First, Windows Communication Foundation, Plugin, Publisher/Subsc<wbr />riber, Inversion of Control / Dependency Injection, Plugin framework, autofac, DDD, multi themes, ioc, Dependency Injection, Inversion of Control, Domain Driven Design, EF code first, SOA, Service Oriented Architecture, DCI, Data Context Interaction, autofac integrated with wcf, automapper, DotNetOpenAuth, DotNetOpenAuth2
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Software Architecture, Web Architecture, Service Architecture
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Web, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">5/18/2012</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/NET-best-practice-samples-4e9b92a4">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p><em>By many years, I always tried to implemented the best sulotion for .NET, specific on C#. Some of my concerns are how we can manage good data access technical, how we can make the plugin framework for easilly maintain and work on big team, how we have
 multi-thems, multi-languages in one site. And now I am really happy, because I can introduce it in this example code.</em></p>
<h2 class="endscriptcode"><span><strong><span>Project Status:</span></strong></span>&nbsp;<span style="color:#ff0000">I<strong>n progress</strong></span></h2>
<h2 class="endscriptcode"><span style="color:#000000"><strong>History:</strong></span></h2>
<div class="endscriptcode"></div>
<div class="endscriptcode">
<ul>
<li><span style="color:#ff0000"><strong><span style="text-decoration:underline">Version 0.5 (18-05-2012):</span></strong>&nbsp;finished integration for Twitter &amp; Google login. Improved for login model. Refactoring all actions related to authentication to
 DCI patterns</span> </li><li><strong><em><span><strong><em><em><strong><em><strong>Version 0.4 (09-05-2012):</strong></em>&nbsp;</strong></em></em></strong></span>Add login with social network accounts using DotNetOpenAuth version 2. Improve DCI architecture on this example.<em>&nbsp;</em><strong><em><strong><strong><strong>&nbsp;</strong></strong><em><strong><em><em><strong><br>
</strong></em></em></strong></em></strong></em></strong></em></strong></li><li><strong><em><span><strong><em><strong>Version 0.3 (29-04-2012)</strong></em>:</strong></span></em></strong>&nbsp;separated code into service, try to build Domain Event, Pub-sub architecture, and DCI as well.<strong><em><span><strong><br>
</strong></span></em></strong></li><li><strong><em><span><strong><em>Version 0.2 (20-04-2012)</em></strong>:&nbsp;</span></em></strong>add new customized controller, customized razor view engine. I am going to integrating multi-themes on razor, but it is still on processing.<strong><em><br>
</em></strong></li><li><strong><em><span>Version 0.1 (18-04-2012)</span></em></strong>: Plugin framework, data access layer using Entity Framework, Ioc container using Autofac
</li></ul>
</div>
<h1><span>Building the Sample</span></h1>
<ul>
<li><em><a href="http://en.wikipedia.org/wiki/Data_access_layer">Data Access Layer</a> (EF with best practices)</em>
</li><li><em><a href="http://en.wikipedia.org/wiki/Plug-in_(computing)">Plugin Framework</a> (based on compiled View)</em>
</li><li><em><a href="http://en.wikipedia.org/wiki/Service-oriented_architecture">SOA</a> (Service Oriented Architecture) using Microsoft WCF 4.0</em>
</li><li><em><a href="http://en.wikipedia.org/wiki/Data,_context_and_interaction">DCI</a> (Data Context Interaction)</em>
</li></ul>
<p><span style="text-decoration:underline">.NET components:</span></p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework">ADO.NET Entity Framework
</a></li><li><a href="http://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CC0QFjAA&amp;url=http%3A%2F%2Fcode.google.com%2Fp%2Fautofac%2F&amp;ei=3rOdT_XrIYm28QPm7tCSDw&amp;usg=AFQjCNETrL3vD8kKlGSMzDTR5y4kbRx76A&amp;sig2=y4x12QQaB4MghHkSNzFbDQ">Autofac</a> for IoC container
</li><li><a href="http://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CDYQFjAA&amp;url=http%3A%2F%2Fwww.asp.net%2Fmvc&amp;ei=C7SdT7_XCsaF8gP185ScDw&amp;usg=AFQjCNEjMxN1d69mJvnErcLHq7mcOPAACQ&amp;sig2=pqyz79KYuwDR3baLuR5C5g">ASP.NET MVC 3.0
</a></li><li><a href="http://www.google.co.uk/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;ved=0CD4QFjAA&amp;url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Fnetframework%2Faa663324&amp;ei=I7SdT-rwGpSr8APUwMyMDw&amp;usg=AFQjCNFYs5AagDZiU_2HYVz3HSCB4jPHgg&amp;sig2=yuwNw0DfYSmDeVc_xUBMyQ">Microsoft
 WCF</a> 4.0 </li><li><a href="http://automapper.org/">AutoMapper</a> </li><li><a href="http://www.dotnetopenauth.net/oauth/dotnetopenauth-4-0-released/">DotNetOpenAuth version 2</a>
</li></ul>
<p><span style="text-decoration:underline">Architecture:</span> <a href="http://en.wikipedia.org/wiki/Domain-driven_design">
Domain Driven Design</a> on design Domain, <a href="http://en.wikipedia.org/wiki/Service-oriented_architecture">
Service Oriented Architecture</a> (SOA)</p>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<p><span style="text-decoration:underline"><em><strong><span style="font-size:medium">Solution structure:</span></strong></em></span></p>
<p><img src="description/btlsolution.png" alt="" width="301" height="618"></p>
<p><span style="text-decoration:underline"><strong><span style="font-size:medium">Guidance for install service:</span></strong></span></p>
<p>You have to host AppServiceIISHost to IIS as below</p>
<p><img src="description/IISHost.png" alt="" width="317" height="471"></p>
<p>&nbsp;</p>
<p>As you see, I host AppSecurity as a service on IIS, and host web application into IIS as well.</p>
<p><span style="text-decoration:underline"><em><strong><span style="font-size:medium">Testing service using wcftestclient tool:</span></strong></em></span></p>
<p><img src="description/wcftestclient.png" alt="" width="1151" height="341"></p>
<p><span style="text-decoration:underline"><em><strong><span style="font-size:medium">Data Connection String:</span></strong></em></span></p>
<p>You have to change database connection string inside web.config in AppSecurityService point to your database server. I give you an example for this as below</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>XML</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">xml</span>
<pre class="hidden">&lt;connectionStrings&gt;    
    &lt;add name=&quot;DefaultConnection&quot;
         providerName=&quot;System.Data.SqlClient&quot;
         connectionString=&quot;Server=.\SQLEXPRESS;Database=AdvertisementDB;Integrated Security=false;
         Persist Security Info=False;User ID=sa;Password=123456;Connect Timeout=120;MultipleActiveResultSets=True;&quot; /&gt;
  &lt;/connectionStrings&gt;</pre>
<div class="preview">
<pre class="js">&lt;connectionStrings&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;add&nbsp;name=<span class="js__string">&quot;DefaultConnection&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;providerName=<span class="js__string">&quot;System.Data.SqlClient&quot;</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connectionString=&quot;Server=.\SQLEXPRESS;Database=AdvertisementDB;Integrated&nbsp;Security=false;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Persist&nbsp;Security&nbsp;Info=False;User&nbsp;ID=sa;Password=<span class="js__num">123456</span>;Connect&nbsp;Timeout=<span class="js__num">120</span>;MultipleActiveResultSets=True;&quot;&nbsp;/&gt;&nbsp;
&nbsp;&nbsp;&lt;/connectionStrings&gt;</pre>
</div>
</div>
</div>
<div class="endscriptcode"><span style="text-decoration:underline"><em><strong><span style="font-size:medium">Login with Social network account:</span></strong></em></span></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">I have updated new features for this sample project. It is login with Social network account using DotNetOpenAuth version 2. As you know, this feature make user is very happy to using your web, because they can use any social account
 (such as facebook, twitter, google, yahoo, linked, windows live,...) to login to your web.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">I have a little demo for this feature as below</div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Login page:</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img src="description/LoginPage_0.png" alt="" width="922" height="447"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Login page with popup:</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img src="description/LoginPage_1.png" alt="" width="608" height="576"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">Sign up new user:</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img src="description/LoginPage_2.png" alt="" width="617" height="684"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode">In the case, you click on facebook icon at login page, it will redirect you to facebook for login like picture as below</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"><img src="description/LoginPage_3.png" alt="" width="1007" height="576"></div>
<div class="endscriptcode">After you sign up in facebook page, it will redirect you to Home page.</div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>
<div class="endscriptcode"></div>

</div>


    </div>
</body>
</html>
