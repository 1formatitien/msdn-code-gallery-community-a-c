# Audio Capture and Play Win32 Application
## Requires
- Visual Studio 2015
## License
- MIT
## Technologies
- Win32
- C++
## Topics
- C++
- RIFF Wave File Processing
- Critical Section
- Audio Capture
## Updated
- 05/10/2016
## Description

<h1>Introduction</h1>
<p><em>This application captures, draws, and plays Resource Interchange File Format (RIFF) audio wave files. The RIFF file format consists of varying length chunkss that have the form: chunk identifier, chunk size in bytes, and chunk data. A RIFF audio wave
 file has a RIFF chunk, a format chunk, a junk chunk, and a audio data chunk.</em></p>
<h1><span>Building the Sample</span></h1>
<p><em>This project should build as is using Visual Studio 2015 Professional.</em></p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p><em>The application has six buttons labeled: &quot;Draw Wave File&quot;, &quot;Start Playing&quot;, &quot;Start Recording&quot;, &quot;Clear Wave Drawing&quot;, &quot;Wave Data Page Up&quot;, and &quot;Wave Data Page Dn&quot;. The first, fifth, and sixth push-buttons control the drawing of the wave audio data is
 unsigned characters (range -128 to &#43;127). The recording buffer is ten minutes long. To record set your sound card so that line in is CD quality (44100&nbsp;samples per second, 16 bits, 2 channels).&nbsp;I leave it up to the user to modify the code to handle
 DVD quality audio <em>(48000&nbsp;samples per second, 16 bits, 2 channels). You have to manually stop the playing. I leave automatic stopping of the audio stream as an assingment for interested users. The application is written in Win32 vanilla C and the main
 source code file is a mere 717 essentially monolithic lines of code which is quite short by Win32 standards.</em></em></p>
<p><em><img id="152825" width="998" height="793" src="152825-audiocaptureandplay%201.png" alt=""><img id="152826" width="998" height="793" src="152826-audiocaptureandplay%202.png" alt=""> &nbsp;&nbsp;</em></p>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C&#43;&#43;</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">cplusplus</span>

<div class="preview">
<pre class="cplusplus"><span class="cpp__mlcom">/*&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Author:&nbsp;James&nbsp;Pate&nbsp;Williams,&nbsp;Jr.&nbsp;(c)&nbsp;2016&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;Audio&nbsp;Capture&nbsp;to&nbsp;RIFF&nbsp;Wave&nbsp;File&nbsp;
*/</span><span class="cpp__preproc">&nbsp;
&nbsp;
#include&nbsp;&lt;fcntl.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;io.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;string.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;time.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;windows.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;commdlg.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;winsock.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;mmsystem.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;process.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;stdlib.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&lt;sys\stat.h&gt;</span><span class="cpp__preproc">&nbsp;
#include&nbsp;&quot;resource.h&quot;</span><span class="cpp__preproc">&nbsp;
&nbsp;
#define&nbsp;NUMBERBUTTONS&nbsp;6</span><span class="cpp__preproc">&nbsp;
#define&nbsp;ACBSIZE&nbsp;2&nbsp;*&nbsp;44100&nbsp;*&nbsp;60&nbsp;*&nbsp;15</span><span class="cpp__preproc">&nbsp;
#define&nbsp;UW_WIDTH&nbsp;1012</span><span class="cpp__preproc">&nbsp;
#define&nbsp;UW_HEIGHT&nbsp;800</span><span class="cpp__preproc">&nbsp;
#define&nbsp;bzero(s,&nbsp;n)&nbsp;memset((s),&nbsp;0,&nbsp;(n));</span>&nbsp;
&nbsp;
<span class="cpp__datatype">char</span>&nbsp;copyright[<span class="cpp__number">256</span>],&nbsp;title[<span class="cpp__number">256</span>];&nbsp;
<span class="cpp__datatype">char</span>&nbsp;data[<span class="cpp__number">4</span>]&nbsp;=&nbsp;{&nbsp;<span class="cpp__string">'d'</span>,&nbsp;<span class="cpp__string">'a'</span>,&nbsp;<span class="cpp__string">'t'</span>,&nbsp;<span class="cpp__string">'a'</span>&nbsp;};&nbsp;
<span class="cpp__datatype">char</span>&nbsp;fmt_[<span class="cpp__number">4</span>]&nbsp;=&nbsp;{&nbsp;<span class="cpp__string">'f'</span>,&nbsp;<span class="cpp__string">'m'</span>,&nbsp;<span class="cpp__string">'t'</span>,&nbsp;<span class="cpp__string">'&nbsp;'</span>&nbsp;};&nbsp;
<span class="cpp__datatype">char</span>&nbsp;junk[<span class="cpp__number">4</span>]&nbsp;=&nbsp;{&nbsp;<span class="cpp__string">'J'</span>,&nbsp;<span class="cpp__string">'U'</span>,&nbsp;<span class="cpp__string">'N'</span>,&nbsp;<span class="cpp__string">'K'</span>&nbsp;};&nbsp;
<span class="cpp__datatype">char</span>&nbsp;riff[<span class="cpp__number">4</span>]&nbsp;=&nbsp;{&nbsp;<span class="cpp__string">'R'</span>,&nbsp;<span class="cpp__string">'I'</span>,&nbsp;<span class="cpp__string">'F'</span>,&nbsp;<span class="cpp__string">'F'</span>&nbsp;};&nbsp;
<span class="cpp__datatype">char</span>&nbsp;wave[<span class="cpp__number">4</span>]&nbsp;=&nbsp;{&nbsp;<span class="cpp__string">'W'</span>,&nbsp;<span class="cpp__string">'A'</span>,&nbsp;<span class="cpp__string">'V'</span>,&nbsp;<span class="cpp__string">'E'</span>&nbsp;};&nbsp;
<span class="cpp__datatype">int</span>&nbsp;handle&nbsp;=&nbsp;-<span class="cpp__number">1</span>,&nbsp;audioLength&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;audioPtr&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
<span class="cpp__datatype">int</span>&nbsp;acbSize&nbsp;=&nbsp;ACBSIZE,&nbsp;fileCount,&nbsp;page;&nbsp;
<span class="cpp__keyword">enum</span>&nbsp;ReadCDRIFFWaveFileError&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;NoError&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;RIFFCorrupt&nbsp;=&nbsp;<span class="cpp__number">1</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;cbSizeFileCorrupt&nbsp;=&nbsp;<span class="cpp__number">2</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;WAVECorrupt&nbsp;=&nbsp;<span class="cpp__number">3</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;fmt_Corrupt&nbsp;=&nbsp;<span class="cpp__number">4</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;cbSizeSubChunkCorrupt&nbsp;=&nbsp;<span class="cpp__number">5</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;AudioFormatError&nbsp;=&nbsp;<span class="cpp__number">6</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;NumChannelsError&nbsp;=&nbsp;<span class="cpp__number">7</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;SampleRateError&nbsp;=&nbsp;<span class="cpp__number">8</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ByteRateError&nbsp;=&nbsp;<span class="cpp__number">9</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;BlockAlignError&nbsp;=&nbsp;<span class="cpp__number">10</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;BitsPerSampleError&nbsp;=&nbsp;<span class="cpp__number">11</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;JUNKCorrupt&nbsp;=&nbsp;<span class="cpp__number">12</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;cbSizeJunkCorrupt&nbsp;=&nbsp;<span class="cpp__number">13</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;DATACorrupt&nbsp;=&nbsp;<span class="cpp__number">14</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;AudioLengthError&nbsp;=&nbsp;<span class="cpp__number">15</span>&nbsp;
};&nbsp;
<span class="cpp__datatype">BOOL</span>&nbsp;drawSelected&nbsp;=&nbsp;FALSE,&nbsp;playSelected&nbsp;=&nbsp;FALSE,&nbsp;recdSelected&nbsp;=&nbsp;FALSE;&nbsp;
<span class="cpp__datatype">BOOL</span>&nbsp;recording&nbsp;=&nbsp;FALSE,&nbsp;playing&nbsp;=&nbsp;FALSE,&nbsp;stopped&nbsp;=&nbsp;FALSE;&nbsp;
<span class="cpp__datatype">BYTE</span>&nbsp;audioCaptureBuffer[ACBSIZE];&nbsp;
<span class="cpp__datatype">BYTE</span>&nbsp;waveHdrBuffer[<span class="cpp__number">2</span>&nbsp;*&nbsp;<span class="cpp__number">44100</span>];&nbsp;
CRITICAL_SECTION&nbsp;cs;&nbsp;
<span class="cpp__datatype">HINSTANCE</span>&nbsp;hInst;&nbsp;
HWAVEIN&nbsp;waveIn;&nbsp;
HWAVEOUT&nbsp;waveOut;&nbsp;
<span class="cpp__datatype">HWND</span>&nbsp;hWnd;&nbsp;
<span class="cpp__datatype">HWND</span>&nbsp;hwndButton[NUMBERBUTTONS];&nbsp;
WAVEFORMATEX&nbsp;waveformat;&nbsp;
WAVEHDR&nbsp;waveHeader;&nbsp;
&nbsp;
<span class="cpp__keyword">void</span>&nbsp;InitializeOpenFilename(OPENFILENAME&nbsp;*openFilename)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;szFilter[]&nbsp;=&nbsp;<span class="cpp__string">&quot;WAVE&nbsp;Files&nbsp;(*.wav)\0*.wav\0\0&quot;</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;memset(openFilename,&nbsp;<span class="cpp__number">0</span>,&nbsp;<span class="cpp__keyword">sizeof</span>(*openFilename));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;openFilename-&gt;lStructSize&nbsp;=&nbsp;<span class="cpp__keyword">sizeof</span>(*openFilename);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;openFilename-&gt;lpstrFilter&nbsp;=&nbsp;szFilter;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;openFilename-&gt;nMaxFile&nbsp;=&nbsp;_MAX_PATH;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;openFilename-&gt;nMaxFileTitle&nbsp;=&nbsp;_MAX_FNAME&nbsp;&#43;&nbsp;_MAX_EXT;&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__datatype">BOOL</span>&nbsp;FindFileHandle(<span class="cpp__datatype">char</span>&nbsp;*filename,&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;output)&nbsp;{&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(output)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle&nbsp;=&nbsp;open(filename,&nbsp;O_BINARY&nbsp;|&nbsp;O_WRONLY&nbsp;|&nbsp;O_CREAT&nbsp;|&nbsp;O_TRUNC,&nbsp;S_IWRITE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;handle&nbsp;=&nbsp;open(filename,&nbsp;O_BINARY&nbsp;|&nbsp;O_RDONLY,&nbsp;S_IREAD);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(handle&nbsp;==&nbsp;-&nbsp;<span class="cpp__number">1</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;can't&nbsp;open&nbsp;file&quot;</span>,&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MB_ICONEXCLAMATION&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;TRUE;&nbsp;
}&nbsp;
&nbsp;
MMRESULT&nbsp;FindSuitableInputDevice(<span class="cpp__datatype">HWND</span>&nbsp;hwndProc)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;waveInOpen(&amp;waveIn,&nbsp;WAVE_MAPPER,&nbsp;&amp;waveformat,&nbsp;hwndProc,&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hInst,&nbsp;CALLBACK_WINDOW);&nbsp;
}&nbsp;
&nbsp;
MMRESULT&nbsp;FindSuitableOutputDevice(<span class="cpp__datatype">HWND</span>&nbsp;hwndProc)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;waveOutOpen(&amp;waveOut,&nbsp;WAVE_MAPPER,&nbsp;&amp;waveformat,&nbsp;hwndProc,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hInst,&nbsp;CALLBACK_WINDOW);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__datatype">BOOL</span>&nbsp;EqualBuffer(<span class="cpp__datatype">BYTE</span>&nbsp;*buffer1,&nbsp;<span class="cpp__datatype">BYTE</span>&nbsp;*buffer2,&nbsp;<span class="cpp__datatype">int</span>&nbsp;length)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;equal&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;i;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;equal&nbsp;&amp;&amp;&nbsp;i&nbsp;&lt;&nbsp;length;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;equal&nbsp;=&nbsp;buffer1[i]&nbsp;==&nbsp;buffer2[i];&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;equal;&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__keyword">void</span>&nbsp;ClearWave(<span class="cpp__datatype">HWND</span>&nbsp;hwnd,&nbsp;<span class="cpp__datatype">int</span>&nbsp;buttonsY)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">HBRUSH</span>&nbsp;wb&nbsp;=&nbsp;(<span class="cpp__datatype">HBRUSH</span>)GetStockObject(WHITE_BRUSH);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">HDC</span>&nbsp;hdc&nbsp;=&nbsp;GetDC(hwnd);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;RECT&nbsp;r,&nbsp;rect;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;GetClientRect(hwnd,&nbsp;&amp;rect);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;rect;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;r.top&nbsp;=&nbsp;rect.top&nbsp;&#43;&nbsp;buttonsY;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;FillRect(hdc,&nbsp;&amp;r,&nbsp;wb);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ReleaseDC(hwnd,&nbsp;hdc);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__keyword">void</span>&nbsp;DrawLine(<span class="cpp__datatype">HDC</span>&nbsp;hdc,&nbsp;<span class="cpp__datatype">int</span>&nbsp;x1,&nbsp;<span class="cpp__datatype">int</span>&nbsp;y1,&nbsp;<span class="cpp__datatype">int</span>&nbsp;x2,&nbsp;<span class="cpp__datatype">int</span>&nbsp;y2)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MoveToEx(hdc,&nbsp;x1,&nbsp;y1,&nbsp;NULL);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;LineTo(hdc,&nbsp;x2,&nbsp;y2);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__keyword">void</span>&nbsp;DrawWave(<span class="cpp__datatype">HWND</span>&nbsp;hwnd,&nbsp;<span class="cpp__datatype">int</span>&nbsp;buttonsY)&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">HDC</span>&nbsp;hdc&nbsp;=&nbsp;GetDC(hwnd);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;RECT&nbsp;rect;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">double</span>&nbsp;xInter,&nbsp;xSlope;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">double</span>&nbsp;yInter,&nbsp;ySlope;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;i,&nbsp;width,&nbsp;height;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;oldX,&nbsp;oldY;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;dMax,&nbsp;dMin;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;iMax,&nbsp;iMin;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;xMax,&nbsp;xMin;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;yMax,&nbsp;yMin;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;GetClientRect(hwnd,&nbsp;&amp;rect);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;=&nbsp;rect.right&nbsp;-&nbsp;rect.left;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;=&nbsp;rect.bottom&nbsp;-&nbsp;rect.top&nbsp;-&nbsp;buttonsY;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;xMin&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;xMax&nbsp;=&nbsp;width&nbsp;-&nbsp;<span class="cpp__number">1</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;yMin&nbsp;=&nbsp;height&nbsp;-&nbsp;<span class="cpp__number">1</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;yMax&nbsp;=&nbsp;buttonsY;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;dMin&nbsp;=&nbsp;&#43;<span class="cpp__number">127</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;dMax&nbsp;=&nbsp;-<span class="cpp__number">128</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;iMin&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;iMax&nbsp;=&nbsp;<span class="cpp__number">256</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;audioLength;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">signed</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;bb&nbsp;=&nbsp;audioCaptureBuffer[i];&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(bb&nbsp;&lt;&nbsp;dMin)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dMin&nbsp;=&nbsp;bb;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(bb&nbsp;&gt;&nbsp;dMax)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dMax&nbsp;=&nbsp;bb;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;xSlope&nbsp;=&nbsp;<span class="cpp__number">1.0</span>&nbsp;/&nbsp;((<span class="cpp__datatype">double</span>)(iMax&nbsp;-&nbsp;iMin)&nbsp;/&nbsp;(xMax&nbsp;-&nbsp;xMin));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ySlope&nbsp;=&nbsp;<span class="cpp__number">1.0</span>&nbsp;/&nbsp;((<span class="cpp__datatype">double</span>)(dMax&nbsp;-&nbsp;dMin)&nbsp;/&nbsp;(yMin&nbsp;-&nbsp;yMax));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;xInter&nbsp;=&nbsp;xMin&nbsp;-&nbsp;xSlope&nbsp;*&nbsp;iMin;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;yInter&nbsp;=&nbsp;yMax&nbsp;-&nbsp;ySlope&nbsp;*&nbsp;dMin;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;iMax;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">signed</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;d&nbsp;=&nbsp;audioCaptureBuffer[<span class="cpp__number">256</span>&nbsp;*&nbsp;page&nbsp;&#43;&nbsp;i];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;x&nbsp;=&nbsp;(<span class="cpp__datatype">int</span>)(xSlope&nbsp;*&nbsp;i&nbsp;&#43;&nbsp;xInter);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;y&nbsp;=&nbsp;(<span class="cpp__datatype">int</span>)(ySlope&nbsp;*&nbsp;d&nbsp;&#43;&nbsp;yInter);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(i&nbsp;==&nbsp;<span class="cpp__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldX&nbsp;=&nbsp;x;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldY&nbsp;=&nbsp;y;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">continue</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawLine(hdc,&nbsp;oldX,&nbsp;oldY,&nbsp;x,&nbsp;y);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldX&nbsp;=&nbsp;x;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oldY&nbsp;=&nbsp;y;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ReleaseDC(hwnd,&nbsp;hdc);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__keyword">enum</span>&nbsp;ReadCDRIFFFileError&nbsp;ReadAudioCDRIFFFile()&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">BYTE</span>&nbsp;DATA[<span class="cpp__number">4</span>],&nbsp;FMT_[<span class="cpp__number">4</span>],&nbsp;JUNK[<span class="cpp__number">4</span>],&nbsp;RIFF[<span class="cpp__number">4</span>],&nbsp;WAVE[<span class="cpp__number">4</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">char</span>&nbsp;junkBuffer[<span class="cpp__number">4096</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;cdSizeData,&nbsp;cbSizeFile,&nbsp;cbSizeJunk,&nbsp;cbSizeSubChunk,&nbsp;x;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;audioFormat;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;numChannels;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;sampleRate;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;byteRate;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;blockAlign;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;bitsPerSample;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;pad;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;RIFF,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(!EqualBuffer(riff,&nbsp;RIFF,&nbsp;<span class="cpp__number">4</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;RIFFCorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;cbSizeFile,&nbsp;<span class="cpp__keyword">sizeof</span>(cbSizeFile));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(cbSizeFile&nbsp;&lt;&nbsp;<span class="cpp__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;cbSizeFileCorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;WAVE,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(!EqualBuffer(wave,&nbsp;WAVE,&nbsp;<span class="cpp__number">4</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;WAVECorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;FMT_,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(!EqualBuffer(fmt_,&nbsp;FMT_,&nbsp;<span class="cpp__number">4</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;fmt_Corrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;cbSizeSubChunk,&nbsp;<span class="cpp__keyword">sizeof</span>(cbSizeSubChunk));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(cbSizeSubChunk&nbsp;!=&nbsp;<span class="cpp__number">18</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;cbSizeSubChunkCorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;audioFormat,&nbsp;<span class="cpp__keyword">sizeof</span>(audioFormat));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(audioFormat&nbsp;!=&nbsp;WAVE_FORMAT_PCM)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;AudioFormatError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;numChannels,&nbsp;<span class="cpp__keyword">sizeof</span>(numChannels));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(numChannels&nbsp;!=&nbsp;<span class="cpp__number">2</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;NumChannelsError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;sampleRate,&nbsp;<span class="cpp__keyword">sizeof</span>(sampleRate));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(sampleRate&nbsp;!=&nbsp;<span class="cpp__number">44100</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;SampleRateError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;byteRate,&nbsp;<span class="cpp__keyword">sizeof</span>(byteRate));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(byteRate&nbsp;!=&nbsp;<span class="cpp__number">44100</span>&nbsp;*&nbsp;<span class="cpp__number">2</span>&nbsp;*&nbsp;<span class="cpp__number">16</span>&nbsp;/&nbsp;<span class="cpp__number">8</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;ByteRateError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;blockAlign,&nbsp;<span class="cpp__keyword">sizeof</span>(blockAlign));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(blockAlign&nbsp;!=&nbsp;<span class="cpp__number">4</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;BlockAlignError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;bitsPerSample,&nbsp;<span class="cpp__keyword">sizeof</span>(bitsPerSample));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(bitsPerSample&nbsp;!=&nbsp;<span class="cpp__number">16</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;BitsPerSampleError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;pad,&nbsp;<span class="cpp__keyword">sizeof</span>(pad));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(x&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;x&nbsp;&lt;&nbsp;<span class="cpp__number">4096</span>;&nbsp;x&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;junkBuffer[x]&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;JUNK,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(!EqualBuffer(junk,&nbsp;JUNK,&nbsp;<span class="cpp__number">4</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;JUNKCorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;cbSizeJunk,&nbsp;<span class="cpp__keyword">sizeof</span>(cbSizeJunk));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(cbSizeJunk&nbsp;&lt;&nbsp;<span class="cpp__number">0</span>&nbsp;||&nbsp;cbSizeJunk&nbsp;&gt;&nbsp;<span class="cpp__number">4096</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;cbSizeJunkCorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;junkBuffer,&nbsp;cbSizeJunk);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;DATA,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(!EqualBuffer(data,&nbsp;DATA,&nbsp;<span class="cpp__number">4</span>))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;DATACorrupt;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;&amp;audioLength,&nbsp;<span class="cpp__keyword">sizeof</span>(audioLength));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(audioLength&nbsp;&lt;&nbsp;<span class="cpp__number">0</span>&nbsp;||&nbsp;audioLength&nbsp;&gt;&nbsp;acbSize)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;AudioLengthError;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;read(handle,&nbsp;audioCaptureBuffer,&nbsp;audioLength);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;audioPtr&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;close(handle);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;NoError;&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__keyword">void</span>&nbsp;WriteAudioCDRIFFFile()&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">char</span>&nbsp;junkBuffer[<span class="cpp__number">4096</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;chunkSize&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;junkSize&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;k,&nbsp;x;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(x&nbsp;=&nbsp;audioLength;&nbsp;x&nbsp;&lt;&nbsp;audioLength&nbsp;&#43;&nbsp;<span class="cpp__number">4096</span>;&nbsp;x&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;(x&nbsp;&#43;&nbsp;<span class="cpp__number">54</span>)&nbsp;%&nbsp;<span class="cpp__number">4096</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(k&nbsp;==&nbsp;<span class="cpp__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;junkSize&nbsp;=&nbsp;(x&nbsp;&#43;&nbsp;<span class="cpp__number">46</span>)&nbsp;%&nbsp;<span class="cpp__number">4096</span>&nbsp;-&nbsp;<span class="cpp__number">46</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chunkSize&nbsp;=&nbsp;audioLength&nbsp;&#43;&nbsp;(x&nbsp;&#43;&nbsp;<span class="cpp__number">46</span>)&nbsp;%&nbsp;<span class="cpp__number">4096</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">break</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;riff,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;chunkSize,&nbsp;<span class="cpp__keyword">sizeof</span>(chunkSize));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;wave,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;fmt_,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;subChunkSize1&nbsp;=&nbsp;<span class="cpp__number">18</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;audioFormat&nbsp;=&nbsp;<span class="cpp__number">1</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;numChannels&nbsp;=&nbsp;<span class="cpp__number">2</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;sampleRate&nbsp;=&nbsp;<span class="cpp__number">44100</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;byteRate&nbsp;=&nbsp;<span class="cpp__number">44100</span>&nbsp;*&nbsp;<span class="cpp__number">2</span>&nbsp;*&nbsp;<span class="cpp__number">16</span>&nbsp;/&nbsp;<span class="cpp__number">8</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;blockAlign&nbsp;=&nbsp;<span class="cpp__number">4</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;bitsPerSample&nbsp;=&nbsp;<span class="cpp__number">16</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">short</span>&nbsp;pad&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;subChunkSize1,&nbsp;<span class="cpp__keyword">sizeof</span>(subChunkSize1));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;audioFormat,&nbsp;<span class="cpp__keyword">sizeof</span>(audioFormat));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;numChannels,&nbsp;<span class="cpp__keyword">sizeof</span>(numChannels));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;sampleRate,&nbsp;<span class="cpp__keyword">sizeof</span>(sampleRate));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;byteRate,&nbsp;<span class="cpp__keyword">sizeof</span>(byteRate));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;blockAlign,&nbsp;<span class="cpp__keyword">sizeof</span>(blockAlign));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;bitsPerSample,&nbsp;<span class="cpp__keyword">sizeof</span>(bitsPerSample));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;pad,&nbsp;<span class="cpp__keyword">sizeof</span>(pad));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(x&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;x&nbsp;&lt;&nbsp;junkSize;&nbsp;x&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;junkBuffer[x]&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;junk,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;junkSize,&nbsp;<span class="cpp__keyword">sizeof</span>(junkSize));&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;junkBuffer,&nbsp;junkSize);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;data,&nbsp;<span class="cpp__number">4</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;&amp;audioLength,&nbsp;<span class="cpp__keyword">sizeof</span>(audioLength));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;write(handle,&nbsp;audioCaptureBuffer,&nbsp;audioLength);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;close(handle);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__datatype">LRESULT</span>&nbsp;CALLBACK&nbsp;WndProc(<span class="cpp__datatype">HWND</span>&nbsp;hwnd,&nbsp;<span class="cpp__datatype">UINT</span>&nbsp;iMsg,&nbsp;<span class="cpp__datatype">WPARAM</span>&nbsp;wParam,&nbsp;<span class="cpp__datatype">LPARAM</span>&nbsp;lParam)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">char</span>&nbsp;none[<span class="cpp__number">32</span>];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">enum</span>&nbsp;ReadCDRIFFWaveFileError&nbsp;error;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">struct</span>&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">long</span>&nbsp;style;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">char</span>&nbsp;*text;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;button[]&nbsp;=&nbsp;{&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Draw&nbsp;Wave&nbsp;Data&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Start&nbsp;Playing&quot;</span>},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Start&nbsp;Recording&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Clear&nbsp;Wave&nbsp;Drawing&quot;</span>&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Wave&nbsp;Data&nbsp;Page&nbsp;Up&quot;</span>&nbsp;&nbsp;},&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;BS_PUSHBUTTON,&nbsp;<span class="cpp__string">&quot;Wave&nbsp;Data&nbsp;Page&nbsp;Dn&quot;</span>&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">DWORD</span>&nbsp;dWord1&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;dWord2&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">HDC</span>&nbsp;hdc;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;PAINTSTRUCT&nbsp;ps;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;RECT&nbsp;rect;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">UINT</span>&nbsp;cbWaveHeader,&nbsp;count&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;i,&nbsp;nDevices,&nbsp;uMessage&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;WSADATA&nbsp;wsaData;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;OPENFILENAME&nbsp;openFilename;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MMRESULT&nbsp;result;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;filename[_MAX_FNAME&nbsp;&#43;&nbsp;<span class="cpp__number">1</span>]&nbsp;=&nbsp;{<span class="cpp__string">'\0'</span>};&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;fileTitle[_MAX_FNAME&nbsp;&#43;&nbsp;_MAX_EXT&nbsp;&#43;&nbsp;<span class="cpp__number">1</span>]&nbsp;=&nbsp;{<span class="cpp__string">'\0'</span>};&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">int</span>&nbsp;cxClient,&nbsp;cyClient;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">int</span>&nbsp;buttonsY,&nbsp;j,&nbsp;chunkSize&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;junkSize&nbsp;=&nbsp;<span class="cpp__number">0</span>,&nbsp;maxPages,&nbsp;playLength,&nbsp;x,&nbsp;y;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;mouseOn&nbsp;=&nbsp;FALSE,&nbsp;rf;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;RECT&nbsp;channelRect[<span class="cpp__number">16</span>];&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">switch</span>&nbsp;(iMsg)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WM_COMMAND:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;openFile;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMRESULT&nbsp;result;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeOpenFilename(&amp;openFilename);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFile&nbsp;=&nbsp;filename;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFileTitle&nbsp;=&nbsp;fileTitle;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.Flags&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(GetOpenFileName(&amp;openFilename))&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFile&nbsp;=&nbsp;FindFileHandle(filename,&nbsp;FALSE);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(openFile)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ReadAudioCDRIFFFile();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxPages&nbsp;=&nbsp;audioLength&nbsp;/&nbsp;<span class="cpp__number">256</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">1</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(playing&nbsp;==&nbsp;FALSE&nbsp;&amp;&amp;&nbsp;playSelected&nbsp;==&nbsp;FALSE)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;openFile;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMRESULT&nbsp;result;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeOpenFilename(&amp;openFilename);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFile&nbsp;=&nbsp;filename;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFileTitle&nbsp;=&nbsp;fileTitle;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.Flags&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(GetOpenFileName(&amp;openFilename))&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFile&nbsp;=&nbsp;FindFileHandle(filename,&nbsp;FALSE);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(openFile)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playSelected&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;FindSuitableOutputDevice(hwnd);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(result&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;find&nbsp;suitable&nbsp;output&nbsp;device&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Error&nbsp;Message&quot;</span>,&nbsp;MB_ICONSTOP&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(handle);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class="cpp__number">1</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">0</span>],&nbsp;FALSE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">2</span>],&nbsp;FALSE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowText((<span class="cpp__datatype">HWND</span>)lParam,&nbsp;<span class="cpp__string">&quot;Stop&nbsp;Playing&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutClose(waveOut);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">0</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">2</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playSelected&nbsp;=&nbsp;playing&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;audioLength&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowText((<span class="cpp__datatype">HWND</span>)lParam,&nbsp;<span class="cpp__string">&quot;Start&nbsp;Playing&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">2</span>)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(recording&nbsp;==&nbsp;FALSE&nbsp;&amp;&amp;&nbsp;recdSelected&nbsp;==&nbsp;FALSE)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">BOOL</span>&nbsp;openFile;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MMRESULT&nbsp;result;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeOpenFilename(&amp;openFilename);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFile&nbsp;=&nbsp;filename;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.lpstrFileTitle&nbsp;=&nbsp;fileTitle;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFilename.Flags&nbsp;=&nbsp;OFN_OVERWRITEPROMPT;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(GetOpenFileName(&amp;openFilename))&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;openFile&nbsp;=&nbsp;FindFileHandle(filename,&nbsp;TRUE);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(openFile)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recdSelected&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;FindSuitableInputDevice(hwnd);&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(result&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;find&nbsp;suitable&nbsp;input&nbsp;device&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Error&nbsp;Message&quot;</span>,&nbsp;MB_ICONSTOP&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(handle);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class="cpp__number">1</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">0</span>],&nbsp;FALSE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">1</span>],&nbsp;FALSE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowText((<span class="cpp__datatype">HWND</span>)lParam,&nbsp;<span class="cpp__string">&quot;Stop&nbsp;Recording&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInStop(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInClose(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">0</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">1</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recdSelected&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowText((<span class="cpp__datatype">HWND</span>)lParam,&nbsp;<span class="cpp__string">&quot;Start&nbsp;Recording&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">3</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">4</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;(page&nbsp;&#43;&nbsp;<span class="cpp__number">1</span>)&nbsp;%&nbsp;maxPages;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;<span class="cpp__keyword">if</span>&nbsp;(LOWORD(wParam)&nbsp;==&nbsp;<span class="cpp__number">5</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;(page&nbsp;-&nbsp;<span class="cpp__number">1</span>)&nbsp;%&nbsp;maxPages;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(page&nbsp;&lt;&nbsp;<span class="cpp__number">0</span>)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;page&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClearWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DrawWave(hwnd,&nbsp;buttonsY);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WM_CREATE:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__mlcom">/*&nbsp;create&nbsp;buttons&nbsp;*/</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;cxChar,&nbsp;cyChar,&nbsp;height,&nbsp;x,&nbsp;y;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">HDC</span>&nbsp;hDC&nbsp;=&nbsp;GetDC(hwnd);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RECT&nbsp;crect;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXTMETRIC&nbsp;textMetric;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetTextMetrics(hDC,&nbsp;&amp;textMetric);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GetClientRect(hwnd,&nbsp;&amp;crect);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cxChar&nbsp;=&nbsp;textMetric.tmAveCharWidth;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cyChar&nbsp;=&nbsp;textMetric.tmHeight&nbsp;&#43;&nbsp;textMetric.tmExternalLeading;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;=&nbsp;<span class="cpp__number">8</span>&nbsp;*&nbsp;cyChar&nbsp;/&nbsp;<span class="cpp__number">4</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;cxChar;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;=&nbsp;cyChar;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buttonsY&nbsp;=&nbsp;<span class="cpp__number">4</span>&nbsp;*&nbsp;cyChar&nbsp;&#43;&nbsp;height;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;NUMBERBUTTONS;&nbsp;i&#43;&#43;)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">int</span>&nbsp;width&nbsp;=&nbsp;<span class="cpp__number">20</span>&nbsp;*&nbsp;cxChar;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hwndButton[i]&nbsp;=&nbsp;CreateWindow(<span class="cpp__string">&quot;button&quot;</span>,&nbsp;button[i].text,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WS_CHILD&nbsp;|&nbsp;WS_VISIBLE&nbsp;|&nbsp;button[i].style,&nbsp;x,&nbsp;y,&nbsp;width,&nbsp;height,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hwnd,&nbsp;(<span class="cpp__datatype">HMENU</span>)i,&nbsp;((LPCREATESTRUCT)lParam)-&gt;hInstance,&nbsp;NULL);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&#43;=&nbsp;width&nbsp;&#43;&nbsp;<span class="cpp__number">4</span>&nbsp;*&nbsp;cxChar;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InitializeCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.cbSize&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.nAvgBytesPerSec&nbsp;=&nbsp;<span class="cpp__number">44100</span>&nbsp;*&nbsp;<span class="cpp__number">2</span>&nbsp;*&nbsp;<span class="cpp__number">16</span>&nbsp;/&nbsp;<span class="cpp__number">8</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.nBlockAlign&nbsp;=&nbsp;<span class="cpp__number">4</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.nChannels&nbsp;=&nbsp;<span class="cpp__number">2</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.nSamplesPerSec&nbsp;=&nbsp;<span class="cpp__number">44100</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.wBitsPerSample&nbsp;=&nbsp;<span class="cpp__number">16</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveformat.wFormatTag&nbsp;=&nbsp;WAVE_FORMAT_PCM;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WM_DESTROY:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(playing)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutClose(waveOut);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(recording)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInStop(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInClose(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PostQuitMessage(<span class="cpp__number">0</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WIM_CLOSE:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(recording)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recording&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WriteAudioCDRIFFFile();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WIM_DATA:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(recording)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;waveHeader.dwBytesRecorded;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;audioCaptureBuffer[audioLength&nbsp;&#43;&nbsp;i]&nbsp;=&nbsp;waveHeader.lpData[i];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;audioLength&nbsp;=&nbsp;(audioLength&nbsp;&#43;&nbsp;waveHeader.dwBytesRecorded)&nbsp;%&nbsp;acbSize;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInAddBuffer(waveIn,&nbsp;&amp;waveHeader,&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WIM_OPEN:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(recdSelected)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bzero(&amp;waveHeader,&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(waveInPrepareHeader(waveIn,&nbsp;&amp;waveHeader,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader))&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;prepare&nbsp;wave&nbsp;header&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;MB_ICONWARNING&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInClose(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.dwBufferLength&nbsp;=&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.lpData&nbsp;=&nbsp;waveHdrBuffer;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bzero(&amp;waveHdrBuffer,&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer))&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(waveInStart(waveIn)&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;start&nbsp;input&nbsp;device&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;MB_ICONWARNING&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInClose(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;((error&nbsp;=&nbsp;waveInAddBuffer(waveIn,&nbsp;&amp;waveHeader,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader)))&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;add&nbsp;buffer&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;MB_ICONWARNING&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveInClose(waveIn);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recording&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WOM_CLOSE:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(playing)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playing&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutClose(waveOut);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">0</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnableWindow(hwndButton[<span class="cpp__number">2</span>],&nbsp;TRUE);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playSelected&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetWindowText((<span class="cpp__datatype">HWND</span>)lParam,&nbsp;<span class="cpp__string">&quot;Start&nbsp;Playing&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WOM_DONE:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(playing)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(audioPtr&nbsp;&#43;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer)&nbsp;&lt;&nbsp;audioLength)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playLength&nbsp;=&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playLength&nbsp;=&nbsp;audioLength&nbsp;%&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;playLength;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.lpData[i]&nbsp;=&nbsp;audioCaptureBuffer[audioPtr&nbsp;&#43;&nbsp;i];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.dwBufferLength&nbsp;=&nbsp;playLength;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutWrite(waveOut,&nbsp;&amp;waveHeader,&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader));&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;audioPtr&nbsp;&#43;=&nbsp;playLength;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">case</span>&nbsp;WOM_OPEN:&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(playSelected)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;((error&nbsp;=&nbsp;ReadAudioCDRIFFFile())&nbsp;!=&nbsp;NoError)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;read&nbsp;RIFF&nbsp;Wave&nbsp;File&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Error&nbsp;Message&quot;</span>,&nbsp;MB_ICONSTOP&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close(handle);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit(<span class="cpp__number">1</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EnterCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(waveOutPrepareHeader(waveOut,&nbsp;&amp;waveHeader,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader))&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;prepare&nbsp;wave&nbsp;header&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;MB_ICONWARNING&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutClose(waveOut);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.lpData&nbsp;=&nbsp;waveHdrBuffer;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;(audioPtr&nbsp;&#43;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer)&nbsp;&lt;&nbsp;audioLength)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playLength&nbsp;=&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">else</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playLength&nbsp;=&nbsp;audioLength&nbsp;%&nbsp;<span class="cpp__keyword">sizeof</span>(waveHdrBuffer);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">for</span>&nbsp;(i&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;i&nbsp;&lt;&nbsp;playLength;&nbsp;i&#43;&#43;)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.lpData[i]&nbsp;=&nbsp;audioCaptureBuffer[audioPtr&nbsp;&#43;&nbsp;i];&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveHeader.dwBufferLength&nbsp;=&nbsp;playLength;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">if</span>&nbsp;((error&nbsp;=&nbsp;waveOutWrite(waveOut,&nbsp;&amp;waveHeader,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">sizeof</span>(waveHeader)))&nbsp;!=&nbsp;MMSYSERR_NOERROR)&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MessageBox(hWnd,&nbsp;<span class="cpp__string">&quot;could&nbsp;not&nbsp;add&nbsp;buffer&quot;</span>,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__string">&quot;Warning&nbsp;Message&quot;</span>,&nbsp;MB_ICONWARNING&nbsp;|&nbsp;MB_OK);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;waveOutClose(waveOut);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;audioPtr&nbsp;&#43;=&nbsp;playLength;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LeaveCriticalSection(&amp;cs);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;playing&nbsp;=&nbsp;TRUE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stopped&nbsp;=&nbsp;FALSE;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;DefWindowProc(hwnd,&nbsp;iMsg,&nbsp;wParam,&nbsp;lParam);&nbsp;
}&nbsp;
&nbsp;
<span class="cpp__datatype">int</span>&nbsp;WINAPI&nbsp;WinMain(<span class="cpp__datatype">HINSTANCE</span>&nbsp;hInstance,&nbsp;<span class="cpp__datatype">HINSTANCE</span>&nbsp;hPrevInstance,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__datatype">PSTR</span>&nbsp;szCmdLine,&nbsp;<span class="cpp__datatype">int</span>&nbsp;iCmdShow)&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;szAppName[]&nbsp;=&nbsp;<span class="cpp__string">&quot;Audio&nbsp;Capture&nbsp;And&nbsp;Playing&nbsp;RIFF&nbsp;Wave&nbsp;File&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">static</span>&nbsp;<span class="cpp__datatype">char</span>&nbsp;title[]&nbsp;=&nbsp;<span class="cpp__string">&quot;Win32&nbsp;Audio&nbsp;Capture&nbsp;Etc.&nbsp;by&nbsp;James&nbsp;Pate&nbsp;Williams,&nbsp;Jr.&nbsp;(c)&nbsp;2016&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;MSG&nbsp;msg;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;WNDCLASSEX&nbsp;&nbsp;wndclass;&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.cbSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span class="cpp__keyword">sizeof</span>&nbsp;(wndclass);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.style&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CS_HREDRAW&nbsp;|&nbsp;CS_VREDRAW;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.lpfnWndProc&nbsp;&nbsp;&nbsp;=&nbsp;WndProc;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.cbClsExtra&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.cbWndExtra&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span class="cpp__number">0</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.hInstance&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;hInstance;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.hIcon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;NULL;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.hCursor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LoadCursor&nbsp;(NULL,&nbsp;IDC_ARROW);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.hbrBackground&nbsp;=&nbsp;(<span class="cpp__datatype">HBRUSH</span>)&nbsp;GetStockObject(WHITE_BRUSH);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.lpszMenuName&nbsp;&nbsp;=&nbsp;NULL;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.lpszClassName&nbsp;=&nbsp;szAppName;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;wndclass.hIconSm&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;NULL;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;RegisterClassEx&nbsp;(&amp;wndclass);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;hWnd&nbsp;=&nbsp;CreateWindow(szAppName,&nbsp;title,&nbsp;WS_OVERLAPPEDWINDOW,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CW_USEDEFAULT,&nbsp;CW_USEDEFAULT,&nbsp;UW_WIDTH,&nbsp;UW_HEIGHT,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NULL,&nbsp;NULL,&nbsp;hInstance,&nbsp;NULL);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;hInst&nbsp;=&nbsp;hInstance;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ShowWindow(hWnd,&nbsp;iCmdShow);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;UpdateWindow(hWnd)&nbsp;;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">while</span>&nbsp;(GetMessage(&amp;msg,&nbsp;NULL,&nbsp;<span class="cpp__number">0</span>,&nbsp;<span class="cpp__number">0</span>))&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TranslateMessage(&amp;msg);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DispatchMessage(&amp;msg);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cpp__keyword">return</span>&nbsp;msg.wParam;&nbsp;
}</pre>
</div>
</div>
</div>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>AudioCaptureToRIFFWaveFile.c - the main and only C source code file of the application.</em>
</li></ul>
<h1>More Information</h1>
<p><em>For more information on the Winmm.lib and this Winmm.dll, see the web and the voluminous amount of Microsoft Win32 documentation. This ancient library has been largely&nbsp;supplanted in modern universal apps.</em></p>
