<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=1AD3141CEA0B7F2E42081F2D1169D116" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=024EBC4B1F0A6478658CF2AC63D4719E" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>CPU Load Generator</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>CPU Load Generator</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, .NET, threading, .NET Framework 4, .NET Framework, Performance Counters, .NET Framework 4.0, C# Language, .NET 4.5, .NET Development
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            C#, threading, Performance, Performance Counters, .NET 4, Generic C# resuable code, Performance testing, Background tasks, Performance &amp; Scalability
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">11/20/2015</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MS-LPL</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/CPU-Load-Generator-f2677be1">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1><strong>Introduction</strong></h1>
<p><strong><br>
</strong></p>
<p><span style="font-size:medium"><em>Ever wonder how you can test your application under heavy CPU load. Your current test environment might not be having that much CPU load.&nbsp;</em></span></p>
<p>&nbsp;</p>
<p><span style="font-size:medium"><em>Here is a simple&nbsp;tool </em></span><span style="font-size:medium"><em>to generate the load across different CPUs on a system. It can be easily deployable on a machine.&nbsp;&nbsp;Just run this tool, tune the CPU load
 according to your requirement &amp; start testing your application.</em></span></p>
<p>&nbsp;</p>
<p><strong>Building the Sample</strong></p>
<p><em>It requires .Net framework 4.0 or above to build and run the application</em></p>
<h1><strong>Description&nbsp;</strong></h1>
<p><span style="font-size:small"><em>Consider a scenario, you have application which just works fine on dev machine but when you deploy it on test or production machine
<strong>having high CPU load, </strong>your application perform badly<strong>.&nbsp;</strong>You want to simulate this behavior in dev environment. How would you make sure that your application works fine even machine has very limited CPU bandwidth available?
 To simulate this behavior you need to have a machine which is which CPU consumption is very high.</em></span></p>
<p><span style="font-size:small"><em>To solve this problem you can use <strong>CPU load Generator.
</strong>Just run the application on your dev or test box (or any other box) &amp; adjust the load as per your requirement. It would create that much load on CPU. Now you can test/run your own application to see how it is going to behave under heavy CPU load.</em></span></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><em>Following are the screenshots. When you open the application, it shows groupbox (having option to select the load) for each CPU on the machine. Click on the radio button to select the load which you want for the given CPU.</em></span></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><em><img id="115067" src="description/cpu load generator.png" alt="" width="476" height="393"></em></span></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><em>As soon as you change the option in UI, CPU load would be adjusted accordingly. You can open the task manager to see the CPU load.</em></span></p>
<p><span style="font-size:small"><em><br>
</em></span></p>
<p><img id="115069" src="description/task manager.png" alt="" width="437" height="486"></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size:medium">Internally it uses Background worker threads to monitor and generate the load on CPU. For thread synchronization it used ManualReset event.</span></p>
<p><span style="font-size:medium">One thread is for continuously monitor the CPU current load &amp; rest are for generating the load on CPU. It used IDiposible pattern to clean up all the resources.</span></p>
<p>&nbsp;</p>
<p><span style="font-size:small"><em><br>
</em></span></p>

</div>


    </div>
</body>
</html>
