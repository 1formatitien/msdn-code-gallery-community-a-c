<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Header,0:HeaderFooterSprite,0:Header.NonMtps;/Areas/Centers/Themes/StandardDevCenter/Content:0&amp;amp;v=875F4807220CE6912BAB87167976178B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:HeaderFooterSprite,0:Footer.NonMtps,1:NewFooterSock,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=10B55093DA08CEEF26023F25F71F9E5B" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Convert HTML to PDF with C# and ASP.NET using NReco PdfGenerator (FREE)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/content/common/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Convert HTML to PDF with C# and ASP.NET using NReco PdfGenerator (FREE)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, ASP.NET, ASP.NET MVC, .NET Framework, ASP.NET Web Forms, ASP.NET Core, ASP.NET Core MVC
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            Data Export, Export to Pdf, HTML to PDF, C# PDF, Html To Pdf Conversion, C# wkhtmltopdf
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Cloud
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">4/6/2017</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">MIT</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Why convert HTML to PDF in C#</h1>
<p><span style="font-size:small">Export to PDF is a common feature in business applications but usage of low level PDF libraries (like iTextSharp or PdfSharp) requires a lot of boilerplate C# code. Applying visual design for PDF exports is very complicated
 with this approach.&nbsp;</span></p>
<p><span style="font-size:small">Fortunately better alternative exists: export content may be prepared as web page (HTML document) and then converted to PDF. Most reliable converters are based on browser engine (WebKit) that renders web page (including execution
 of js code) like a real web browser.</span></p>
<p><span style="font-size:small">One of the most popular HTML-to-PDF convertsion tool is
<a href="http://wkhtmltopdf.org/" >wkhtmltopdf</a>. In this example we use
<a href="https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://www.nrecosite.com/pdf_generator_net.aspx">NReco PdfGenerator</a>&nbsp;.NET wrapper that embeds wkhtmltopdf and provides simple API to execute it.<br>
</span></p>
<p>&nbsp;</p>
<p><span style="font-size:20px; font-weight:bold">PdfGenerator usage<br>
</span></p>
<p><span style="font-size:small">Install <a href="https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://www.nuget.org/packages/NReco.PdfGenerator/" >
NReco.PdfGenerator nuget package</a>: &quot;install-package NReco.PdfGenerator&quot;</span></p>
<p><span style="font-size:small">The following code snippet illustrates PdfGenerator API usage:</span></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span>
<pre class="hidden">using NReco.PdfGenerator;

....

var htmlToPdf = new HtmlToPdfConverter();

var pdfBytesFromUrl = htmlToPdf.GeneratePdfFromFile(webPageUrl, null);
var pdfBytesFromHtmlString = htmlToPdf.GeneratePdf(htmlContent, null);</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;NReco.PdfGenerator;&nbsp;
&nbsp;
....&nbsp;
&nbsp;
var&nbsp;htmlToPdf&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;HtmlToPdfConverter();&nbsp;
&nbsp;
var&nbsp;pdfBytesFromUrl&nbsp;=&nbsp;htmlToPdf.GeneratePdfFromFile(webPageUrl,&nbsp;<span class="cs__keyword">null</span>);&nbsp;
var&nbsp;pdfBytesFromHtmlString&nbsp;=&nbsp;htmlToPdf.GeneratePdf(htmlContent,&nbsp;<span class="cs__keyword">null</span>);</pre>
</div>
</div>
</div>
<p><span style="font-size:small">That's all! Wkhtmltopdf is automatically extracted on first use (by default it is extracted to app bin folder, but location may be changed with &quot;PdfToolPath&quot; property).</span></p>
<p><span style="font-size:small">PdfGenerator has special build (<a href="https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://www.nuget.org/packages/NReco.PdfGenerator.LT">NReco.PdfGenerator.LT</a>) that can be used from .NET Core projects, more details can be found on&nbsp;<a href="https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://code.msdn.microsoft.com/Convert-HTML-to-PDF-with-C-8adc7650/https://www.nrecosite.com/pdf_generator_net.aspx">PdfGenerator
 website</a>.<br>
</span></p>
<h1><span>Building the Sample</span></h1>
<p><span style="font-size:small">Examples package includes 2 projects:</span><em>&nbsp;</em></p>
<ul>
<li><span style="font-size:small">NReco.PdfGenerator.Examples.DemoMvc - ASP.NET MVC example</span>
</li><li><span style="font-size:small">NReco.PdfGenerator.Examples.DemoWebForms - ASP.NET WebForms example</span>
</li></ul>
<p><span style="font-size:small">Functionality in these projects is the same; it is possible to specify HTML template within textarea or specify web page URL for PDF generation.</span></p>

</div>


    </div>
</body>
</html>
