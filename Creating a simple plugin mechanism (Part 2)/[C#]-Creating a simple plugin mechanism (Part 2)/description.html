<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/Header.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/sprite.css" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="/Areas/Epx/Themes/Windows/Content/UhfHeader.css" data-do-not-move="true" />
<link rel="stylesheet" href="https://statics-uhf-wus.akamaized.net/west-european/shell/_scrf/css/themes=default.device=uplevel_web_pc/23-2974dc/fb-9ad7a5/64-048a31/ff-3826ee/fb-cee6a6/b0-6b159a/e5-55b2aa/62-186d68?ver=2.0" type="text/css" media="all" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:Footer,0:sprite,1:SelectLocaleFromPopUp;/Areas/Epx/Themes/Windows/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;v=88F29B4C8FDEAE405E4FEA25E70366FE" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="https://i-msdn.sec.s-msft.com/Areas/Epx/Themes/Windows/Content/UhfFooter.css?v=636765551546130442" data-do-not-move="true" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Creating a simple plugin mechanism (Part 2)</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" /><link href="description/49b6a5b0-0da5-43dc-a484-4544ca823787Brand.css" type="text/css" rel="Stylesheet" />
        <link href="https://i1.code.msdn.s-msft.com/windowsdesktop/content/windowsdesktop/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="https://i1.code.msdn.s-msft.com/windowsdesktop/content/common/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Creating a simple plugin mechanism (Part 2)</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            C#, WPF, Visual Basic .NET, MEF, Managed Extensibility Framework, VB.Net, Generics, Plugin
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            MEF, Managed Extensibility Framework, Generics, Plugin
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">1/30/2019</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<h1>Introduction</h1>
<p>This sample shows how to create your own simple plugin mechanism with MEF (Managed Extensibility Framework).</p>
<p>There are situations where you want to extend your application without changing existing code. So you need only to deliver new assemblies. Also other developers could extend your application. There are several mechanisms to solve this problem.</p>
<h1><span>Building the Sample</span></h1>
<p>Build first the Plugin projects</p>
<ul>
<li>FirstPlugin </li><li>SecondPlugin </li></ul>
<p>to ensure that the Plugins folder contains the plugin DLLs.</p>
<p><span style="font-size:20px; font-weight:bold">Description</span></p>
<p>To solve this problem, we build up on the first part of creating a simple plugin mechanism
<a href="http://code.msdn.microsoft.com/Creating-a-simple-plugin-b6174b62">http://code.msdn.microsoft.com/Creating-a-simple-plugin-b6174b62</a>. As in the first part plugins are searched and loaded from a predefined location. The created plugins are projects
 in form of built assemblies (DLLs).</p>
<p>We are using the same Interface that all plugins must implement as in the first part.<em>
<br>
</em></p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">namespace PluginContracts
{
	public interface IPlugin
	{
		string Name { get; }
		void Do();
	}
}</pre>
<pre class="hidden">Public Interface IPlugin
    ReadOnly Property Name() As String
    Sub DoSomething()
End Interface
</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">namespace</span>&nbsp;PluginContracts&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">interface</span>&nbsp;IPlugin&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">string</span>&nbsp;Name&nbsp;{&nbsp;<span class="cs__keyword">get</span>;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">void</span>&nbsp;Do();&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}</pre>
</div>
</div>
</div>
<p>In the source of the plugins that we want to provide, we have to make our first changes. We have to add the reference to <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Composition.aspx"  title="Auto generated link to System.ComponentModel.Composition">System.ComponentModel.Composition</a> and using System.ComponentModel.Composition. Now we can mark the class with the Export attribute. So
 the MEF will later find and process this class. Furthermore the type is explicit stated. Hence we want to use the interface rather than the concrete class in the main project.</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">using <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Composition.aspx"  title="Auto generated link to System.ComponentModel.Composition">System.ComponentModel.Composition</a>;
using PluginContracts;

namespace FirstPlugin
{
	[Export(typeof(IPlugin))]
	public class FirstPlugin : IPlugin
	{
		#region IPlugin Members

		public string Name
		{
			get
			{
				return &quot;First Plugin&quot;;
			}
		}

		public void Do()
		{
			<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.Windows.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.MessageBox.Show">System.Windows.MessageBox.Show</a>(&quot;Do Something in First Plugin&quot;);
		}

		#endregion
	}
}</pre>
<pre class="hidden">Imports PluginContracts
Imports <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Composition.aspx"  title="Auto generated link to System.ComponentModel.Composition">System.ComponentModel.Composition</a>

&lt;Export(GetType(IPlugin))&gt;
Public Class FirstPlugin
    Implements IPlugin

    Public Sub DoSomething() Implements IPlugin.DoSomething
        <a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.Windows.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.MessageBox.Show">System.Windows.MessageBox.Show</a>(&quot;Do Something in First Plugin&quot;)
    End Sub

    Public ReadOnly Property Name As String Implements IPlugin.Name
        Get
            Return &quot;First Plugin&quot;
        End Get
    End Property
End Class</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">using</span>&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.ComponentModel.Composition.aspx"  title="Auto generated link to System.ComponentModel.Composition">System.ComponentModel.Composition</a>;&nbsp;
<span class="cs__keyword">using</span>&nbsp;PluginContracts;&nbsp;
&nbsp;
<span class="cs__keyword">namespace</span>&nbsp;FirstPlugin&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;[Export(<span class="cs__keyword">typeof</span>(IPlugin))]&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">class</span>&nbsp;FirstPlugin&nbsp;:&nbsp;IPlugin&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="cs__preproc">&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#region&nbsp;IPlugin&nbsp;Members</span>&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">string</span>&nbsp;Name&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">get</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">return</span>&nbsp;<span class="cs__string">&quot;First&nbsp;Plugin&quot;</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">public</span>&nbsp;<span class="cs__keyword">void</span>&nbsp;Do()&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="libraryLink" href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://msdn.microsoft.com/en-US/library/System.Windows.MessageBox.Show.aspx"  title="Auto generated link to System.Windows.MessageBox.Show">System.Windows.MessageBox.Show</a>(<span class="cs__string">&quot;Do&nbsp;Something&nbsp;in&nbsp;First&nbsp;Plugin&quot;</span>);&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<span class="cs__preproc">&nbsp;
&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endregion</span>&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;
}</pre>
</div>
</div>
</div>
<div class="endscriptcode">This is all we have to do, to provide a plugin in MEF. But so that this works, we need to implement the mechanism in our main application that knows how to find and how to handle the plugins. For that we are using methods provided
 by MEF.</div>
<p class="endscriptcode">So that we can use the Export marked parts, we have to mark properties with the Import attribute. In our case we want to use several exported parts, so we are using the ImportMany attribute.</p>
<p class="endscriptcode">&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">[ImportMany]
public IEnumerable&lt;IPlugin&gt; Plugins
{
    get;
    set;
}</pre>
<pre class="hidden">    &lt;ImportMany&gt;
    Public Property Plugins As IEnumerable(Of IPlugin)</pre>
<div class="preview">
<pre class="csharp">[ImportMany]&nbsp;
<span class="cs__keyword">public</span>&nbsp;IEnumerable&lt;IPlugin&gt;&nbsp;Plugins&nbsp;
{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">get</span>;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;<span class="cs__keyword">set</span>;&nbsp;
}</pre>
</div>
</div>
</div>
<div class="endscriptcode">Last we need to search for the exported and imported parts and compose them. As in the first part we specify a folder in that all plugins are put in.</div>
<p>&nbsp;</p>
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">public MEFPluginLoader(string path)
{
  DirectoryCatalog directoryCatalog = new DirectoryCatalog(path);

  //An aggregate catalog that combines multiple catalogs
  var catalog = new AggregateCatalog(directoryCatalog);

  // Create the CompositionContainer with all parts in the catalog (links Exports and Imports)
  _Container = new CompositionContainer(catalog);

  //Fill the imports of this object
  _Container.ComposeParts(this);
}</pre>
<pre class="hidden">    Sub New(path As String)
        Dim directoryCatalog As DirectoryCatalog = New DirectoryCatalog(path)

        'An aggregate catalog that combines multiple catalogs
        Dim catalog = New AggregateCatalog(directoryCatalog)

        'Create the CompositionContainer with all parts in the catalog (links Exports and Imports)
        _Container = New CompositionContainer(catalog)

        'Fill the imports of this object
        _Container.ComposeParts(Me)
    End Sub</pre>
<div class="preview">
<pre class="csharp"><span class="cs__keyword">public</span>&nbsp;MEFPluginLoader(<span class="cs__keyword">string</span>&nbsp;path)&nbsp;
{&nbsp;
&nbsp;&nbsp;DirectoryCatalog&nbsp;directoryCatalog&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;DirectoryCatalog(path);&nbsp;
&nbsp;
&nbsp;&nbsp;<span class="cs__com">//An&nbsp;aggregate&nbsp;catalog&nbsp;that&nbsp;combines&nbsp;multiple&nbsp;catalogs</span>&nbsp;
&nbsp;&nbsp;var&nbsp;catalog&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;AggregateCatalog(directoryCatalog);&nbsp;
&nbsp;
&nbsp;&nbsp;<span class="cs__com">//&nbsp;Create&nbsp;the&nbsp;CompositionContainer&nbsp;with&nbsp;all&nbsp;parts&nbsp;in&nbsp;the&nbsp;catalog&nbsp;(links&nbsp;Exports&nbsp;and&nbsp;Imports)</span>&nbsp;
&nbsp;&nbsp;_Container&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;CompositionContainer(catalog);&nbsp;
&nbsp;
&nbsp;&nbsp;<span class="cs__com">//Fill&nbsp;the&nbsp;imports&nbsp;of&nbsp;this&nbsp;object</span>&nbsp;
&nbsp;&nbsp;_Container.ComposeParts(<span class="cs__keyword">this</span>);&nbsp;
}</pre>
</div>
</div>
</div>
<div class="endscriptcode">So far we have searched and initialized our plugins, so we can use the implemented properties and methods of our plugins as in the first part. To access our plugins we use the implemented MEFPluginLoader.</div>
<div class="endscriptcode">
<div class="scriptcode">
<div class="pluginEditHolder" pluginCommand="mceScriptCode">
<div class="title"><span>C#</span><span>Visual Basic</span></div>
<div class="pluginLinkHolder"><span class="pluginEditHolderLink">Edit</span>|<span class="pluginRemoveHolderLink">Remove</span></div>
<span class="hidden">csharp</span><span class="hidden">vb</span>
<pre class="hidden">MEFPluginLoader loader = new MEFPluginLoader(&quot;Plugins&quot;);
IEnumerable&lt;IPlugin&gt; plugins = loader.Plugins;</pre>
<pre class="hidden">        Dim loader = New MEFPluginLoader(&quot;Plugins&quot;)
        Dim plugins = loader.Plugins</pre>
<div class="preview">
<pre class="csharp">MEFPluginLoader&nbsp;loader&nbsp;=&nbsp;<span class="cs__keyword">new</span>&nbsp;MEFPluginLoader(<span class="cs__string">&quot;Plugins&quot;</span>);&nbsp;
IEnumerable&lt;IPlugin&gt;&nbsp;plugins&nbsp;=&nbsp;loader.Plugins;</pre>
</div>
</div>
</div>
<div class="endscriptcode">&nbsp;All other things can be borrowed from the first part.</div>
<h2>Improvement</h2>
<p>So that we do not need to implement for each new solution its own plugin loader, we use as in the first part Generics. This allows us to remove the dependence from a certain plugin interface (here IPlugin).</p>
<h1><span>Source Code Files</span></h1>
<ul>
<li><em>source code file name MEFPluginLoader.cs - searches and loads plugins..</em>
</li><li><em><em>source code file name MEFGenericPluginLoader.cs - generic version of PluginLoader.</em></em>
</li><li><em><em>source code file name MainWindow.xaml.cs - making plugins in gui available.</em></em>
</li><li><em><em>source code file name IPlugin.cs - interface for plugin implementation.</em></em>
</li><li><em><em>source code file name FirstPlugin.cs - first plugin implementation.</em></em>
</li><li><em><em>source code file name SecondPlugin.cs - second plugin implementation.</em></em>
</li></ul>
<h1>More Information</h1>
<p><strong>For further code samples visit <em><a href="http://chrigas.blogspot.com/">http://chrigas.blogspot.com/</a></em></strong></p>
<p>For more information on the first part (Creating a simple plugin mechanism), see
<a href="http://code.msdn.microsoft.com/Creating-a-simple-plugin-b6174b62">http://code.msdn.microsoft.com/Creating-a-simple-plugin-b6174b62</a></p>
<p>For more information on the extended part (Creating a simple plugin mechanism (extended)), see
<a href="https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/Creating-a-simple-plugin-5fc67c9a">https://code.msdn.microsoft.com/windowsdesktop/Creating-a-simple-plugin-b45f1d4e/https://code.msdn.microsoft.com/Creating-a-simple-plugin-5fc67c9a</a></p>
<p>For more information on MEF, see <a href="http://msdn.microsoft.com/en-us/library/vstudio/dd460648.aspx">
http://msdn.microsoft.com/en-us/library/vstudio/dd460648.aspx</a>, <a href="http://mef.codeplex.com/">
http://mef.codeplex.com/</a>, and <a href="http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.composition.aspx">
http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.composition.aspx</a></p>
<a href="http://msdn.microsoft.com/en-us/library/vstudio/system.componentmodel.composition.aspx"></a>For more information on Generics, see
<a href="http://msdn.microsoft.com/en-us/library/512aeb7t.aspx">http://msdn.microsoft.com/en-us/library/512aeb7t.aspx</a>,
<a href="http://msdn.microsoft.com/en-us/library/ms172192.aspx">http://msdn.microsoft.com/en-us/library/ms172192.aspx</a>, and
<a href="http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx ">
http://msdn.microsoft.com/en-us/library/system.collections.generic.aspx </a></div>
<div class="endscriptcode"></div>

</div>


    </div>
</body>
</html>
